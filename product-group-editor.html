<!DOCTYPE html>
<html lang="en" ng-app="theApp">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>Product Group Editor | BTBADMIN</title>
        <!-- Bootstrap -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <!-- JWL CSS stylesheet -->
        <link href="css/jwl.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="js/jquery.min.js"></script>
        <!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="js/bootstrap.min.js"></script>
        <!-- AngularJS -->
        <script src="js/angular.min.js"></script>
        <!-- JWL JavaScript -->
        <script src="js/jwl.js"></script>
        <!-- This page's NG app/controller -->
        <script>
            angular.module("theApp",[]).controller("MainController",function($http){
                var self = this;
                self.columns = [];
                self.results = [];
                self.getColumns = function(){
                    $http.get("js/get-columns-results.json").then(function(response){
                        self.columns = response.data;
                    },function(response){});
                };
                self.getProductGroup = function(){
                    if (self.searchField&&self.searchValue) $http.get("js/get-group-results.json",{params:{field:self.searchField,value:self.searchValue}}).then(function(response){
                        self.results = response.data;
                    },function(response){});
                };
                self.getColumns();
            });
        </script>
    </head>
    <body ng-controller="MainController as mc">
        <ng-include src="'incl/navbar.html'"></ng-include>
        <ng-include src="'incl/alerts.html'"></ng-include>
        <div class="container jwl-normal-container">
            <h1>Product Group Editor</h1>
            <p><form role="form" class="form-inline">
                <div class="form-group">
                    <select class="form-control" ng-model="mc.searchField">
                        <option value="PR_SKU">PR_SKU</option>
                        <option value="PR_ProductCategory">PR_ProductCategory</option>
                        <option value="PR_Description">PR_Description</option>
                        <option value="PR_Keywords">PR_Keywords</option>
                        <option value="PR_UDSearch0">PR_UDSearch0</option>
                        <option value="PR_UDSearch1">PR_UDSearch1</option>
                    </select>
                </div>
                <div class="form-group"><input class="form-control" type="text" ng-model="mc.searchValue"></div>
                <button type="submit" ng-click="mc.getProductGroup()" class="btn btn-primary"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search</button>
            </form></p>
            <p><span ng-repeat="(columnName,columnMeta) in mc.columns"><button type="button" ng-click="columnMeta.show = !columnMeta.show" ng-hide="columnMeta.show" class="btn btn-xs btn-success">{{columnName}}</button> </span></p>
            <table class="table table-bordered">
                <thead>
                <tr>
                    <td ng-repeat="(columnName,columnMeta) in mc.columns" ng-show="columnMeta.show"><button type="button" ng-click="columnMeta.show = !columnMeta.show" class="btn btn-xs btn-success">{{columnName}}</button></td>    
                </tr>
                </thead>
                <tr ng-repeat="resultRow in mc.results">
                    <td ng-repeat="(resultCol,resultCell) in resultRow" ng-show="mc.columns[resultCol].show">
                        <div ng-click="editing = true">
                            <a>{{resultCell}}</a>&nbsp;
                        </div>
                        <div style="position:absolute" ng-show="editing">
                            <form role="form" class="form-inline">
                                <div class="form-group"><input class="form-control" type="text" ng-model="resultCell"></div>
                                <button type="button" class="btn btn-default"><span class="glyphicon glyphicon-list" aria-hidden="true"></span></button>
                                <button type="submit" class="btn btn-primary" ng-click="editing = false"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button>
                            </form>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
        <ng-include src="'incl/footer.html'"></ng-include>
    </body>
</html>